<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" href="/assets/favicon.ico">


    
    
    <title>Azure Active Directory와 G Suite간의 계정 연동 · 클라우드메이트 기술 블로그🦒</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="/style.main.min.1c44ef757733a95a69ebeab5705dffb87cc959be77e0322886578445a720d13b.css" />

    
    <link rel="stylesheet" href="/style.custom.min.4010cd9138a45a5fa78cfb660d7afa1b5428163368418ac96394477c89168dd2.css" />
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146594086-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta property="og:title" content="Azure Active Directory와 G Suite간의 계정 연동" />
<meta property="og:description" content="Azure Active Directory와 G Suite 연동하기 Azure AD 에서 사용자를 관리하고 있지만, G Suite를 사용해야 하는 경우가 발생할 수 있습니다. 이 상태에서 사용자의 생성" />

<meta property="article:author" content="박상엽"/>



<meta property="og:image" content="/2020/05/11/gsuitsyncazuread/images/81523738-bf72dd00-9389-11ea-8270-aeef3b303d40.png" />
</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
        <div class="site-nav-left">
            
                <a class="site-nav-logo" href="/">클라우드메이트 기술 블로그🦒</a>
            
            <div class="site-nav-content">
                    <ul class="nav" role="menu">
                        
                        <li class="nav-home" role="menuitem"><a href="/categories/hands-on">Hands On</a></li>
                        
                        <li class="nav-home" role="menuitem"><a href="/categories/tech">Tech</a></li>
                        
                        <li class="nav-home" role="menuitem"><a href="/categories/column">Column</a></li>
                        
                        <li class="nav-home" role="menuitem"><a href="/categories/mate-story">Mate Story</a></li>
                        
                        
                        <li class="nav-home" role="menuitem"><a href=""></a></li>
                        
                    </ul>
            </div>
        </div>
    
  
</nav></div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">
                
                    <section class="post-full-tags">
                    
                    
                        <a href="/categories/hands-on"><b>Hands on</b></a>
                    
                    
                        <a href="/tags/azure-active-directory" class="tag">#Azure Active Directory</a>
                    
                        <a href="/tags/azure-ad" class="tag">#Azure AD</a>
                    
                        <a href="/tags/g-suite" class="tag">#G Suite</a>
                    
                    </section>
                
                <h1 class="post-full-title">Azure Active Directory와 G Suite간의 계정 연동</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
  <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>박상엽</h2>
                </div>
            </div>
        </div>
        <a href="/authors/sangyeop-park/" class="static-avatar author-profile-image">
            
                <div class="author-profile"
                    style="background: url(/authors/sangyeop-park/%eb%b0%95%ec%83%81%ec%97%bd.jpg) no-repeat center; 
                    background-size: cover; width: 30px; height: 30px; 
                    border-radius: 100%; margin-bottom: 10px;">
                </div>
            
        </a>
    </li>
  

</ul>

                        <section class="post-full-byline-meta">
                            
                                
                                <h4 class="author-name">박상엽</h4>
                                
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-125-05">2020. 05. 11.</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 5 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            
            <figure class="post-full-image">
                <img src="images/81523738-bf72dd00-9389-11ea-8270-aeef3b303d40.png" alt="Azure Active Directory와 G Suite간의 계정 연동" />
            </figure>
            

            <section class="post-full-content">
                <div class="post-content">
                    <h2 id="azure-active-directory와-g-suite-연동하기">Azure Active Directory와 G Suite 연동하기</h2>
<p>Azure AD 에서 사용자를 관리하고 있지만, G Suite를 사용해야 하는 경우가 발생할 수 있습니다.
이 상태에서 사용자의 생성 및 삭제와 관련된 모든 작업은 Azure AD에서만 진행 하고, G Suite에서는 메일 및 메신저와 같은 기능을 사용할 때, 관리자는 어떤 작업이 필요하게 될 지 고민하게 됩니다.</p>
<p>이런 상황에서 관리자는 고민을 하게 됩니다.</p>
<p>하나의 관리 지점에서 어떻게 하면 Azure Active Directory와 G Suite를 사용할 수 있을까?</p>
<p>위 질문은 Azure Active Directory와 G Suite 간의 SSO (Single Sign-On) 기능 구현으로 도달하게 됩니다.</p>
<p>Microsoft 에서는 이를 해결하기 위해 앱을 통하여 Azure Active Directory에서 사용자를 관리하고, G Suite을 사용하게 가능한 Google Cloud (G Suite) Connector를 Enterprise Application에 추가하게 됩니다.</p>
<p>이 기능을 통해 다음과 같은 환경 구성이 가능하게 됩니다.</p>
<p><img src="images/81523738-bf72dd00-9389-11ea-8270-aeef3b303d40.png" alt="image"></p>
<pre><code>•	 Azure Active Directory에서는 관리자가 사용자의 생성 및 삭제와 관련된 작업을 진행하게 됩니다.
•	 생성된 사용자는 Provisioning 기능을 통해, G Suite 으로 계정이 생성 및 동기화가 됩니다.
</code></pre>
<p>현재 상태는 다음과 같습니다.</p>
<pre><code>•	 G Suite에서는 Cloudmt.fun 이라는 도메인을 사용하여 메일 송수신이 가능한 상태
•	 Azure Active Directory에서는 사용자 지정 도메인으로 Cloudmt.fun 도메인을 사용하고 있는 상태
•	 Azure Active Directory와 G Suite 간의 동일한 UPN을 가진 사용자는 존재하지 않음
</code></pre>
<p>위와 같은 구성을 위해서는 다음과 같은 작업이 필요합니다.</p>
<p>Microsoft Azure에서 Azure Active Directory의 Enterprise Application으로 이동합니다.
이동을 한 후엔, 추가 버튼을 클릭하여 Google Cloud / G Suite Connector by Microsoft를 클릭하여 Azure Active Directory에 앱을 추가합니다.
<img src="images/81523840-12e52b00-938a-11ea-9116-6d9e6f0c4faa.png" alt="image"></p>
<p>잠깐의 시간이 흐른 뒤 앱은 정상적으로 등록이 되며,
Enterprise Application의 앱에서 추가된 Google Cloud / G Suite Connector by Microsoft 앱을 클릭하면 다음과 같은 화면을 볼 수 있습니다.
<img src="images/81523865-2beddc00-938a-11ea-9076-006c56ab9ad4.png" alt="image"></p>
<p>Google Cloud / G Suite Connector by Microsoft 개요 탭에서 Getting Started를 보시면, 앱을 추가 한 다음 진행해야 할 작업이 나열되어 있습니다. 최초에 진행 할 작업은 사용자 및 그룹 할당입니다.
<img src="images/81523882-35774400-938a-11ea-918b-8c795f1ba321.png" alt="image"></p>
<p>사용자 및 그룹 추가 메뉴를 선택하여 이 앱을 사용할 사용자를 선택합니다.
화면에서는 사용자만을 추가하기 위해서 사용자 추가 화면으로 진행하였습니다.
사용자 추가를 클릭하여, 기존에 Azure Active Directory에 존재하는 사용자를 추가합니다.
<img src="images/81523906-4b850480-938a-11ea-8802-cc61514fbc69.png" alt="image"></p>
<p>다음은 Single Sign-on 설정입니다. Single Sign-on 설정을 통해 Azure Active Directory의 사용자를 G Suite으로 동기화 합니다. 선택 후 SAML을 선택합니다.
SAML이란? 인증 정보 제공자(identity provider)와 서비스 제공자(service provider) 간의 인증 및 인가 데이터를 교환하기 위한 XML 기반의 개방형 표준 데이터 포맷을 의미합니다.
<img src="images/81524000-a61e6080-938a-11ea-9569-b02de1b1264f.png" alt="image"></p>
<p>SSO 방식을 SAML 방식으로 변경하면 다음과 같은 화면이 진행되며, SAML 기반 로그인에 대한 설정을 진행합니다.
<img src="images/81524016-b1718c00-938a-11ea-8b7c-128ee54c8cad.png" alt="image"></p>
<p>기본 SAML 구성에서 우측에 연필 모양 아이콘을 클릭하여 값을 수정합니다.
<img src="images/81524056-ca7a3d00-938a-11ea-9c7b-97fe4c28162e.png" alt="image"></p>
<p>•	식별자(엔터티 ID)
입력 방식은 위와 같이 <a href="https://google.com/a/mydomadin">https://google.com/a/mydomadin</a> 형식으로 변경하여 입력합니다.
사진에서는 사용 중인 도메인이 cloudmt.fun이기 때문에 <a href="https://google.com/a/cloudmt.fun">https://google.com/a/cloudmt.fun</a> 으로 입력하였습니다.</p>
<p>•	회신 URL (Assertion Consumer Service URL) 또한 위와 마찬가지로 도메인을 변경하여 입력합니다.</p>
<p>•	로그온 URL을 두어 정상적으로 로그온 할 수 있는 주소를 입력합니다. 이 로그온 URL 또한 중간에 도메인을 변경하여 입력합니다.</p>
<p>이제 두 번째로 사용자 특성 및 클레임을 입력합니다.
<img src="images/81524152-162ce680-938b-11ea-8f1c-d024dfad9c91.png" alt="image"><br>
(위 설정은 앱을 추가하면 기본으로 설정되는 사용자 특성 및 클레임입니다.)
<img src="images/81524170-23e26c00-938b-11ea-97ed-4f588d507a03.png" alt="image"><br>
사용자를 매핑하는 기준은 사용자의 UPN을 기준으로 이루어지기 때문에, 다른 클레임은 필요하지 않습니다.
추가 클레임을 전부 삭제 한 후에 고유 클레임을 남겨둡니다.
(고유 클레임은 삭제할 수 없습니다.)</p>
<p>3번 단계인 SAML 서명 인증서는 차후에, G Suite에서 설정이 필요하기 때문에, 우선은 파일을 받아둡니다. (Base64로 인증서를 다운로드 합니다.)<br>
<img src="images/81524206-43799480-938b-11ea-8bda-7fce98e3480c.png" alt="image"><br>
(인증서는 정해진 기간이 있기 때문에, 알림 전자 메일을 통해 해당 인증서가 만료되기 전에 교체하는 작업이 필요합니다. 인증서가 만료되면 SSO는 동작하지 않습니다.)</p>
<p>4번 단계의 정보를 G Suite에 입력하기 위해 다음의 정보를 복사합니다.
<img src="images/81524230-555b3780-938b-11ea-8377-8f6dcde09fdd.png" alt="image"></p>
<p>위 정보를 복사 한 후에 G Suite (admin.google.com) 으로 이동한 다음, 관리 콘솔의 보안 &gt; 설정으로 이동하여 &lsquo;타사 ldP를 사용해 싱글 사인온(SSO) 설정&rsquo;으로 이동합니다.
<img src="images/81524241-5db37280-938b-11ea-8228-ab8fa89e7e8c.png" alt="image"><br>
(타사 ID 제공업체에 SSO 설정 체크 후
로그인 페이지 URL, 로그아웃 페이지 URL을 Azure Portal에서 확인된 4번의 항목에서 복사 후 붙여넣기를 합니다. 마지막으로 도메인별 발행자 사용을 체크 한 후 해당 내역을 저장합니다.)</p>
<p>위 작업까지 완료되었을 경우, 다시 Azure Portal로 돌아옵니다.
돌아온 후에, 프로비전 중 메뉴로 처음 들어가게 되면, 아래와 같이 프로비전 모드를 자동으로 바꿔줍니다.
<img src="images/81524279-876c9980-938b-11ea-846b-1986b9b935cc.png" alt="image"></p>
<p>관리자 자격 증명을 입력 할 경우 Google 관리 센터에 접근하는 계정을 입력합니다.
해당 계정은 Google에서 최고 관리자 권한을 가지고 있는 계정으로 접근합니다.<br>
<img src="images/81524293-92bfc500-938b-11ea-8316-91c0d53756ae.png" alt="image"></p>
<p>현 단계에서 연결 테스트를 거치지 않고 프로비전이 실패할 경우를 대비하여, 알림 전자 메일 및 오류 발생 시 전자 메일 보내기를 선택합니다.<br>
<img src="images/81524477-50e34e80-938c-11ea-8bca-f10f881dba68.png" alt="image"></p>
<p>매핑 부분에서는 어떠한 값이 매핑 되는지를 확인할 수 있습니다. (사용자 및 그룹)
<img src="images/81524508-6b1d2c80-938c-11ea-871c-1bb3d190c420.png" alt="image"><br>
(하기 화면은 사용자 특성 매핑 화면입니다.)
<img src="images/81524551-8f790900-938c-11ea-9d4a-93ff21e9d78d.png" alt="image"></p>
<p>이제 하단의 프로비전 상태를 설정으로 표시하고 저장을 다시 저장을 클릭합니다.
(프로비저닝은 40분을 기준으로 자동으로 진행되며 프로비저닝 주기를 임의로 변경할 수는 없지만, 바로 실행은 가능합니다.)</p>
<blockquote>
<p>설정 전
<img src="images/81524571-9bfd6180-938c-11ea-95f8-205db725e334.png" alt="image">
설정 후
<img src="images/81524587-a91a5080-938c-11ea-8585-9115cd2614b6.png" alt="image"></p>
</blockquote>
<p>위 단원까지 완료하였을 경우, 정상적으로 Azure Active Directory에서 G Suite으로 계정이 프로비전 됩니다.</p>
<pre><code>•	 사용자가 생성될 경우 동일한 이름의 사용자가 G Suite에 있어선 안됩니다.
•	 G Suite에서 사용자 계정이 자동으로 정지됨 일 경우 사용자가 로그인하여 해당 문제를 해결할 수 있습니다.
•	 프로비저닝 실패에 대한 로그는 프로비저닝 감사 로그를 통해 확인할 수 있습니다.
</code></pre>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/categories/hands-on">Hands on</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
                <li>
                    <h4><a href="/2021/02/17/spot_by_netapp_%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0/">Spot By NetApp 시작하기</a></h4>
                    <div class="read-next-card-meta">
                            <p><time datetime="2021-122-02">2021. 02. 17.</time> 
                                
                            </p>
                    </div>
                </li>
                
                <li>
                    <h4><a href="/2020/12/11/ngfw%EB%A1%9C-acme%EC%9D%98-%ED%8A%B8%EB%9E%9C%EC%A7%93-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-%EB%B3%B4%ED%98%B8/">AWS Re:Invent 2020 JAM으로 알아보는 NGFW로 네트워크 보안 강화하기</a></h4>
                    <div class="read-next-card-meta">
                            <p><time datetime="2020-1212-12">2020. 12. 11.</time> 
                                
                            </p>
                    </div>
                </li>
                
                <li>
                    <h4><a href="/2020/12/10/datadog-log-indexing/">Datadog에 Indexing 되는 로그에 대한 비용 최적화 하는 방법</a></h4>
                    <div class="read-next-card-meta">
                            <p><time datetime="2020-712-12">2020. 12. 10.</time> 
                                
                            </p>
                    </div>
                </li>
                
            </ul>
        </div>
    </article>
<article class="post-card post


 ">

        
            <a class="post-card-image-link" href="/2020/04/22/vsonlinereview/">
                <img class="post-card-image"src="/2020/04/22/vsonlinereview/images/%28new%29first_main.png" alt="Visual Studio Online 리뷰"/>
            </a>
        
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/2020/04/22/vsonlinereview/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Hands on</div>
                    

                    <h2 class="post-card-title">Visual Studio Online 리뷰</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Visual Studio Codespace. (추가) 5월 1일 일자로 서비스 명 변경. Visual Studio Online -&gt; Visual Studio Codespace 특징 대부분의 프로그래밍 언어를 지원하는 가상 환경(Cloud-hosted)을 제공하고,&#8230;</p>
                </section>
    
            </a>

            
                
                
                <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip"><b>박영진</b>님의 글 모두 보기</div>
                            <a href="/authors/youngjin-park/" class="static-avatar author-profile-image">
                            
                                <div class="author-profile"
                                    style="background: url(/authors/youngjin-park/%eb%b0%95%ec%98%81%ec%a7%84.jpg) no-repeat center; 
                                    background-size: cover; width: 30px; height: 30px; 
                                    border-radius: 100%; margin-bottom: 10px;">
                                </div>
                            
                            </a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>박영진</span>
                        <span class="post-card-byline-date"><time datetime="2020-124-04">2020. 04. 22.</time>
                            <span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </footer>
                
            
        </div>

</article>

            <article class="post-card post


 ">

        
            <a class="post-card-image-link" href="/2020/06/01/vsonlinereview2/">
                <img class="post-card-image"src="/2020/06/01/vsonlinereview2/images/attention.png" alt="Visual Studio Online 리뷰2 - 협업(Live Share)"/>
            </a>
        
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/2020/06/01/vsonlinereview2/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Hands on</div>
                    

                    <h2 class="post-card-title">Visual Studio Online 리뷰2 - 협업(Live Share)</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Visual Studio Codespace 협업기능 사용방법 1. Azure Account 설치 2. Live Share Extension 설치 Live Share Extension Pack Live Share Whiteboard 설치 후 Reload 3. Start (세션 시작) 협업 세션 시작을 통해 시작할 수 있으며, 세션 만들어지고 url공유&#8230;</p>
                </section>
    
            </a>

            
                
                
                <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip"><b>박영진</b>님의 글 모두 보기</div>
                            <a href="/authors/youngjin-park/" class="static-avatar author-profile-image">
                            
                                <div class="author-profile"
                                    style="background: url(/authors/youngjin-park/%eb%b0%95%ec%98%81%ec%a7%84.jpg) no-repeat center; 
                                    background-size: cover; width: 30px; height: 30px; 
                                    border-radius: 100%; margin-bottom: 10px;">
                                </div>
                            
                            </a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>박영진</span>
                        <span class="post-card-byline-date"><time datetime="2020-126-06">2020. 06. 01.</time>
                            <span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </footer>
                
            
        </div>

</article>
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright">
                    
                    <a href="https://cloudmt.co.kr" target="_blank" rel="noopener">
                    <img src="/assets/images/CMLOGO_WHITE.png" style="height: 40px"/>
                    </a>
                    
                </section>
                <nav class="site-footer-nav">
                    <a href="https://fb.me/cloudmatekr" target="_blank" rel="noopener">Facebook</a>
                    
                    <a href="https://github.com/mate365" target="_blank" rel="noopener">Github</a>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3</a>
                    <a href="/">
                    
                    © 2019-Present CLOUDMATE Corp
                    
                    </a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>